(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const g of a.addedNodes)g.tagName==="LINK"&&g.rel==="modulepreload"&&i(g)}).observe(document,{childList:!0,subtree:!0});function s(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(n){if(n.ep)return;n.ep=!0;const a=s(n);fetch(n.href,a)}})();const O=e=>new Date(e).toLocaleDateString(),T=e=>{e.sort((r,s)=>s.rating-r.rating)},$=e=>{e.sort((r,s)=>r.rating-s.rating)},k=e=>{e.sort((r,s)=>{const i=new Date(r.registration_date.split(".").reverse().join("-"));return new Date(s.registration_date.split(".").reverse().join("-"))-i})},x=e=>{e.sort((r,s)=>{const i=new Date(r.registration_date.split(".").reverse().join("-")),n=new Date(s.registration_date.split(".").reverse().join("-"));return i-n})},A=(e,r,s)=>{e.classList.add("popup--open"),document.body.classList.add("no-scroll"),s.dataset.id=r},P=e=>{e.classList.remove("popup--open"),document.body.classList.remove("no-scroll")},H=async()=>fetch("https://5ebbb8e5f2cfeb001697d05c.mockapi.io/users",{method:"GET",redirect:"follow"}),U=async()=>{let e=[];return await H().then(r=>{if(!r.ok)throw new Error("Error");return r.json()}).then(r=>{e=r,e.forEach(s=>{s.registration_date=O(s.registration_date)})}).catch(r=>{console.log(r)}),e},E=document.querySelector(".table__content"),f=document.querySelector(".filter__rating"),v=document.querySelector(".filter__reg"),u=document.querySelector(".table__pagination"),h=document.querySelector(".search__input"),w=document.querySelector(".popup"),q=document.querySelector(".js-close"),y=document.querySelector(".js-delete"),D=document.querySelector(".js-clear"),I=async()=>{let e=await U(),r=5,s=0,i=null,n=!1,a=[];const g=o=>o.map(t=>`
    <tr class="table__tr" data-id=${t.id}>
        <td class="table__cell table__cell--name">
            <span>${t.username}<span/>
        </td>
        <td class="table__cell">
            ${t.email}
        </td>
        <td class="table__cell">
            ${t.registration_date}
        </td>
        <td class="table__cell">
            ${t.rating}
        </td>
        <td class="table__cell">
          <button class="button table__cell-close" data-id=${t.id}></button>
        </td>
  </tr>
    `).join(""),S=()=>{h.value=""},l=async(o,t)=>{const c=t*r,d=c+r;return i=o.slice(c,d),E.innerHTML=`${g(i)}`,i},L=o=>{const t=Math.ceil(o.length/r);for(let c=0;c<t;c++){const d=document.createElement("li");d.classList.add("table__pagination-item"),d.textContent=c+1,u.appendChild(d),document.querySelectorAll(".table__pagination-item")[0].classList.add("active"),d.addEventListener("click",()=>{s=c,S(),n?(l(a,s),console.log(a)):l(e,s)})}};u==null||u.addEventListener("click",o=>{const t=o.target;t&&(t.classList.contains("active")||(document.querySelector(".table__pagination-item.active").classList.remove("active"),t.classList.add("active")))});const M=o=>{console.log("delete user");const t=e.findIndex(c=>c.id===o);t>-1&&e.splice(t,1),u.innerHTML="",h.value="",L(e),l(e,s)},j=o=>{s=0;let t=[],c=o.value.trim().toLowerCase();f.classList.remove("active"),v.classList.remove("active"),e.forEach(d=>{if(d.username.toLowerCase().includes(c)||d.email.toLowerCase().includes(c)){if(c!==""){t.push(d),u.innerHTML="",l(t,s),n=!0;const C=Math.ceil(t.length/r);for(let _=0;_<C;_++){const b=document.createElement("li");b.textContent=_+1,u.appendChild(b),b.classList.add("table__pagination-item"),document.querySelectorAll(".table__pagination-item")[0].classList.add("active"),b.addEventListener("click",()=>{s=_,l(t,s)})}return t&&n}c==""&&(u.innerHTML="",L(e),l(e,s))}})};L(e),l(e,s),h.addEventListener("input",o=>{const t=o.target;j(t),console.log(t.value.trim().toLowerCase())});let p=0,m=0;f.addEventListener("click",()=>(p++,f.classList.add("active"),v.classList.remove("active"),a=[...e],p==1&&T(a),p==2&&($(a),p=0),S(),l(a,s),n=!0,n)),v.addEventListener("click",()=>(m++,f.classList.remove("active"),v.classList.add("active"),a=[...e],m==1&&k(a),m==2&&(x(a),m=0),S(),l(a,s),n=!0,n)),E.addEventListener("click",o=>{const t=o.target.dataset.id;t&&A(w,t,y)}),q==null||q.addEventListener("click",()=>{P(w)}),y==null||y.addEventListener("click",o=>{const t=o.target.dataset.id;M(t),P(w)}),D==null||D.addEventListener("click",()=>{if(n)return h.value="",f.classList.remove("active"),v.classList.remove("active"),u.innerHTML="",E.innerHTML="",L(e),l(e,s),n=!1,p=0,m=0,n})};document.addEventListener("DOMContentLoaded",I);
